{
    "NiftiPreprocessingPiece": {
        "name": "NiftiPreprocessingPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "medical-imaging",
            "nifti",
            "preprocessing",
            "normalization",
            "radiology"
        ],
        "style": {
            "node_label": "Preprocess NIfTI",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:filter",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "NIfTI Preprocessing",
        "description": "Preprocesses NIfTI medical imaging data with normalization (z-score, min-max, percentile), optional resizing, and conversion to NumPy format for efficient ML training.",
        "container_resources": {
            "cpu": 500,
            "memory": "2Gi"
        },
        "input_schema": {
            "$defs": {
                "NormalizationMethod": {
                    "description": "Normalization methods for medical images",
                    "enum": [
                        "zscore",
                        "minmax",
                        "percentile",
                        "none"
                    ],
                    "title": "NormalizationMethod",
                    "type": "string"
                },
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "NIfTI Preprocessing Piece Input Model",
            "properties": {
                "subjects": {
                    "description": "List of subjects to preprocess",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Subjects",
                    "type": "array"
                },
                "output_dir": {
                    "default": "/home/shared_storage/medical_data/preprocessed",
                    "description": "Directory to save preprocessed data",
                    "title": "Output Dir",
                    "type": "string"
                },
                "normalization": {
                    "allOf": [
                        {
                            "$ref": "#/$defs/NormalizationMethod"
                        }
                    ],
                    "default": "zscore",
                    "description": "Normalization method to apply"
                },
                "lower_percentile": {
                    "default": 1.0,
                    "description": "Lower percentile for clipping (used with 'percentile' normalization)",
                    "maximum": 50.0,
                    "minimum": 0.0,
                    "title": "Lower Percentile",
                    "type": "number"
                },
                "upper_percentile": {
                    "default": 99.0,
                    "description": "Upper percentile for clipping (used with 'percentile' normalization)",
                    "maximum": 100.0,
                    "minimum": 50.0,
                    "title": "Upper Percentile",
                    "type": "number"
                },
                "save_as_numpy": {
                    "default": true,
                    "description": "Save preprocessed data as NumPy arrays (.npy) for faster loading",
                    "title": "Save As Numpy",
                    "type": "boolean"
                },
                "target_shape": {
                    "anyOf": [
                        {
                            "items": {
                                "type": "integer"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Target shape for resizing (e.g., [128, 128, 64]). None = keep original.",
                    "title": "Target Shape"
                }
            },
            "required": [
                "subjects"
            ],
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "PreprocessedSubject": {
                    "description": "Information about a preprocessed subject",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "original_image_path": {
                            "title": "Original Image Path",
                            "type": "string"
                        },
                        "preprocessed_image_path": {
                            "title": "Preprocessed Image Path",
                            "type": "string"
                        },
                        "preprocessed_mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Preprocessed Mask Path"
                        },
                        "original_shape": {
                            "items": {
                                "type": "integer"
                            },
                            "title": "Original Shape",
                            "type": "array"
                        },
                        "preprocessed_shape": {
                            "items": {
                                "type": "integer"
                            },
                            "title": "Preprocessed Shape",
                            "type": "array"
                        },
                        "image_stats": {
                            "title": "Image Stats",
                            "type": "object"
                        }
                    },
                    "required": [
                        "subject_id",
                        "original_image_path",
                        "preprocessed_image_path",
                        "original_shape",
                        "preprocessed_shape",
                        "image_stats"
                    ],
                    "title": "PreprocessedSubject",
                    "type": "object"
                }
            },
            "description": "NIfTI Preprocessing Piece Output Model",
            "properties": {
                "preprocessed_subjects": {
                    "description": "List of preprocessed subjects with paths and statistics",
                    "items": {
                        "$ref": "#/$defs/PreprocessedSubject"
                    },
                    "title": "Preprocessed Subjects",
                    "type": "array"
                },
                "output_dir": {
                    "description": "Directory containing preprocessed data",
                    "title": "Output Dir",
                    "type": "string"
                },
                "num_processed": {
                    "description": "Number of successfully preprocessed subjects",
                    "title": "Num Processed",
                    "type": "integer"
                },
                "num_failed": {
                    "description": "Number of subjects that failed preprocessing",
                    "title": "Num Failed",
                    "type": "integer"
                },
                "preprocessing_config": {
                    "description": "Configuration used for preprocessing",
                    "title": "Preprocessing Config",
                    "type": "object"
                }
            },
            "required": [
                "preprocessed_subjects",
                "output_dir",
                "num_processed",
                "num_failed",
                "preprocessing_config"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/NiftiPreprocessingPiece"
    },
    "DataSplitPiece": {
        "name": "DataSplitPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "data-processing",
            "train-test-split",
            "machine-learning",
            "preprocessing"
        ],
        "style": {
            "node_label": "Data Split",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:code-branch",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "Data Split",
        "description": "Splits dataset subjects into train/validation/test sets with configurable ratios. Supports random and sequential splitting strategies.",
        "container_resources": {
            "cpu": 100,
            "memory": "128Mi"
        },
        "input_schema": {
            "$defs": {
                "SplitStrategy": {
                    "description": "Strategy for splitting data",
                    "enum": [
                        "random",
                        "sequential"
                    ],
                    "title": "SplitStrategy",
                    "type": "string"
                },
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "Data Split Piece Input Model",
            "properties": {
                "subjects": {
                    "description": "List of subjects to split (from NiftiDataLoaderPiece)",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Subjects",
                    "type": "array"
                },
                "train_ratio": {
                    "default": 0.7,
                    "description": "Proportion of data for training (0.0-1.0)",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Train Ratio",
                    "type": "number"
                },
                "val_ratio": {
                    "default": 0.15,
                    "description": "Proportion of data for validation (0.0-1.0)",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Val Ratio",
                    "type": "number"
                },
                "test_ratio": {
                    "default": 0.15,
                    "description": "Proportion of data for testing (0.0-1.0). If not specified, uses remaining data.",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Test Ratio",
                    "type": "number"
                },
                "random_seed": {
                    "anyOf": [
                        {
                            "type": "integer"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": 42,
                    "description": "Random seed for reproducible splits",
                    "title": "Random Seed"
                },
                "split_strategy": {
                    "allOf": [
                        {
                            "$ref": "#/$defs/SplitStrategy"
                        }
                    ],
                    "default": "random",
                    "description": "Strategy for splitting: 'random' shuffles data, 'sequential' keeps order"
                }
            },
            "required": [
                "subjects"
            ],
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "Data Split Piece Output Model",
            "properties": {
                "train_subjects": {
                    "description": "Subjects assigned to training set",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Train Subjects",
                    "type": "array"
                },
                "val_subjects": {
                    "description": "Subjects assigned to validation set",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Val Subjects",
                    "type": "array"
                },
                "test_subjects": {
                    "description": "Subjects assigned to test set",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Test Subjects",
                    "type": "array"
                },
                "train_count": {
                    "description": "Number of training subjects",
                    "title": "Train Count",
                    "type": "integer"
                },
                "val_count": {
                    "description": "Number of validation subjects",
                    "title": "Val Count",
                    "type": "integer"
                },
                "test_count": {
                    "description": "Number of test subjects",
                    "title": "Test Count",
                    "type": "integer"
                },
                "total_count": {
                    "description": "Total number of subjects",
                    "title": "Total Count",
                    "type": "integer"
                },
                "split_info": {
                    "description": "Summary information about the split",
                    "title": "Split Info",
                    "type": "object"
                }
            },
            "required": [
                "train_subjects",
                "val_subjects",
                "test_subjects",
                "train_count",
                "val_count",
                "test_count",
                "total_count",
                "split_info"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/DataSplitPiece"
    },
    "PituitaryDatasetPiece": {
        "name": "PituitaryDatasetPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "medical-imaging",
            "pytorch",
            "dataset",
            "segmentation",
            "pituitary"
        ],
        "style": {
            "node_label": "Pituitary Dataset",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:database",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "Pituitary Dataset Creator",
        "description": "Creates PyTorch-compatible dataset configurations for pituitary gland segmentation. Generates dataset configs and provides code for creating DataLoaders.",
        "container_resources": {
            "cpu": 200,
            "memory": "512Mi"
        },
        "input_schema": {
            "$defs": {
                "PreprocessedSubject": {
                    "description": "Information about a preprocessed subject",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "original_image_path": {
                            "title": "Original Image Path",
                            "type": "string"
                        },
                        "preprocessed_image_path": {
                            "title": "Preprocessed Image Path",
                            "type": "string"
                        },
                        "preprocessed_mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Preprocessed Mask Path"
                        },
                        "original_shape": {
                            "items": {
                                "type": "integer"
                            },
                            "title": "Original Shape",
                            "type": "array"
                        },
                        "preprocessed_shape": {
                            "items": {
                                "type": "integer"
                            },
                            "title": "Preprocessed Shape",
                            "type": "array"
                        },
                        "image_stats": {
                            "title": "Image Stats",
                            "type": "object"
                        }
                    },
                    "required": [
                        "subject_id",
                        "original_image_path",
                        "preprocessed_image_path",
                        "original_shape",
                        "preprocessed_shape",
                        "image_stats"
                    ],
                    "title": "PreprocessedSubject",
                    "type": "object"
                }
            },
            "description": "Pituitary Dataset Piece Input Model",
            "properties": {
                "train_subjects": {
                    "anyOf": [
                        {
                            "items": {
                                "$ref": "#/$defs/PreprocessedSubject"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Preprocessed training subjects",
                    "title": "Train Subjects"
                },
                "val_subjects": {
                    "anyOf": [
                        {
                            "items": {
                                "$ref": "#/$defs/PreprocessedSubject"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Preprocessed validation subjects",
                    "title": "Val Subjects"
                },
                "test_subjects": {
                    "anyOf": [
                        {
                            "items": {
                                "$ref": "#/$defs/PreprocessedSubject"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Preprocessed test subjects",
                    "title": "Test Subjects"
                },
                "data_dir": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": "/home/shared_storage/medical_data/preprocessed",
                    "description": "Directory containing preprocessed 'images' and 'masks' subdirectories",
                    "title": "Data Dir"
                },
                "batch_size": {
                    "default": 2,
                    "description": "Batch size for DataLoader",
                    "minimum": 1,
                    "title": "Batch Size",
                    "type": "integer"
                },
                "num_workers": {
                    "default": 0,
                    "description": "Number of workers for DataLoader",
                    "minimum": 0,
                    "title": "Num Workers",
                    "type": "integer"
                },
                "shuffle_train": {
                    "default": true,
                    "description": "Whether to shuffle training data",
                    "title": "Shuffle Train",
                    "type": "boolean"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "DatasetInfo": {
                    "description": "Information about a created dataset",
                    "properties": {
                        "split_name": {
                            "title": "Split Name",
                            "type": "string"
                        },
                        "num_samples": {
                            "title": "Num Samples",
                            "type": "integer"
                        },
                        "batch_size": {
                            "title": "Batch Size",
                            "type": "integer"
                        },
                        "num_batches": {
                            "title": "Num Batches",
                            "type": "integer"
                        },
                        "subject_ids": {
                            "items": {
                                "type": "string"
                            },
                            "title": "Subject Ids",
                            "type": "array"
                        }
                    },
                    "required": [
                        "split_name",
                        "num_samples",
                        "batch_size",
                        "num_batches",
                        "subject_ids"
                    ],
                    "title": "DatasetInfo",
                    "type": "object"
                },
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "Pituitary Dataset Piece Output Model",
            "properties": {
                "train_info": {
                    "anyOf": [
                        {
                            "$ref": "#/$defs/DatasetInfo"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Information about training dataset"
                },
                "val_info": {
                    "anyOf": [
                        {
                            "$ref": "#/$defs/DatasetInfo"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Information about validation dataset"
                },
                "test_info": {
                    "anyOf": [
                        {
                            "$ref": "#/$defs/DatasetInfo"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Information about test dataset"
                },
                "data_dir": {
                    "description": "Directory containing the data",
                    "title": "Data Dir",
                    "type": "string"
                },
                "dataset_config_path": {
                    "description": "Path to saved dataset configuration JSON file",
                    "title": "Dataset Config Path",
                    "type": "string"
                },
                "subjects": {
                    "anyOf": [
                        {
                            "items": {
                                "$ref": "#/$defs/SubjectInfo"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Combined list of all subjects for downstream pieces (e.g., ModelTrainingPiece)",
                    "title": "Subjects"
                }
            },
            "required": [
                "train_info",
                "val_info",
                "test_info",
                "data_dir",
                "dataset_config_path"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/PituitaryDatasetPiece"
    },
    "NiftiDataLoaderPiece": {
        "name": "NiftiDataLoaderPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "medical-imaging",
            "nifti",
            "data-loading",
            "radiology",
            "preprocessing"
        ],
        "style": {
            "node_label": "NIfTI Loader",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:file-medical",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "NIfTI Data Loader",
        "description": "Discovers and loads NIfTI medical imaging data (.nii.gz files). Pairs images with corresponding segmentation masks based on filename matching.",
        "container_resources": {
            "cpu": 100,
            "memory": "256Mi"
        },
        "input_schema": {
            "description": "NIfTI Data Loader Piece Input Model",
            "properties": {
                "images_path": {
                    "default": "/home/shared_storage/medical_data/images",
                    "description": "Path to the directory containing NIfTI image files (.nii.gz)",
                    "title": "Images Path",
                    "type": "string"
                },
                "masks_path": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": "/home/shared_storage/medical_data/masks",
                    "description": "Path to the directory containing NIfTI mask/segmentation files (.nii.gz). Optional for inference-only mode.",
                    "title": "Masks Path"
                },
                "file_pattern": {
                    "default": "*.nii.gz",
                    "description": "Glob pattern to match NIfTI files (e.g., 'sub-*.nii.gz')",
                    "title": "File Pattern",
                    "type": "string"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "NIfTI Data Loader Piece Output Model",
            "properties": {
                "subjects": {
                    "description": "List of discovered subjects with their image and mask paths",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Subjects",
                    "type": "array"
                },
                "num_subjects": {
                    "description": "Total number of subjects found",
                    "title": "Num Subjects",
                    "type": "integer"
                },
                "images_dir": {
                    "description": "Path to images directory",
                    "title": "Images Dir",
                    "type": "string"
                },
                "masks_dir": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "description": "Path to masks directory (if provided)",
                    "title": "Masks Dir"
                }
            },
            "required": [
                "subjects",
                "num_subjects",
                "images_dir",
                "masks_dir"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/NiftiDataLoaderPiece"
    },
    "ModelTrainingPiece": {
        "name": "ModelTrainingPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "Medical Imaging",
            "Deep Learning",
            "Training",
            "UNet",
            "SwinUNETR",
            "Segmentation",
            "PyTorch"
        ],
        "style": {
            "node_label": "Model Training",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#99ccff"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:brain",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "description": "Trains 3D medical image segmentation models (UNet/SwinUNETR) using patch-based training with data augmentation and comprehensive metrics tracking",
        "input_schema": {
            "$defs": {
                "ModelArchitecture": {
                    "description": "Supported model architectures",
                    "enum": [
                        "unet",
                        "swin_unetr"
                    ],
                    "title": "ModelArchitecture",
                    "type": "string"
                },
                "SubjectInfo": {
                    "description": "Information about a single subject - compatible with upstream pieces",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "Model Training Piece Input Model",
            "properties": {
                "subjects": {
                    "anyOf": [
                        {
                            "items": {
                                "$ref": "#/$defs/SubjectInfo"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "List of subjects from upstream piece (e.g., NiftiDataLoaderPiece, PituitaryDatasetPiece). If provided, dataset_config_path is ignored.",
                    "title": "Subjects"
                },
                "dataset_config_path": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Path to dataset_config.json generated by PituitaryDatasetPiece. Used only if subjects is None.",
                    "title": "Dataset Config Path"
                },
                "data_root": {
                    "default": "/home/shared_storage/medical_data",
                    "description": "Root directory containing images and masks subdirectories (used when loading from config file)",
                    "title": "Data Root",
                    "type": "string"
                },
                "train_val_split": {
                    "default": 0.8,
                    "description": "Train/validation split ratio when using subjects input (0.0-1.0). E.g., 0.8 means 80% train, 20% val.",
                    "maximum": 0.95,
                    "minimum": 0.1,
                    "title": "Train Val Split",
                    "type": "number"
                },
                "output_dir": {
                    "default": "/home/shared_storage/models",
                    "description": "Directory to save trained models and training logs",
                    "title": "Output Dir",
                    "type": "string"
                },
                "model_architecture": {
                    "allOf": [
                        {
                            "$ref": "#/$defs/ModelArchitecture"
                        }
                    ],
                    "default": "unet",
                    "description": "Model architecture to use"
                },
                "num_classes": {
                    "default": 6,
                    "description": "Number of segmentation classes (including background)",
                    "minimum": 2,
                    "title": "Num Classes",
                    "type": "integer"
                },
                "epochs": {
                    "default": 100,
                    "description": "Number of training epochs",
                    "maximum": 500,
                    "minimum": 1,
                    "title": "Epochs",
                    "type": "integer"
                },
                "batch_size": {
                    "default": 4,
                    "description": "Batch size for training",
                    "maximum": 32,
                    "minimum": 1,
                    "title": "Batch Size",
                    "type": "integer"
                },
                "learning_rate": {
                    "default": 0.0001,
                    "description": "Initial learning rate",
                    "exclusiveMaximum": 1.0,
                    "exclusiveMinimum": 0.0,
                    "title": "Learning Rate",
                    "type": "number"
                },
                "weight_decay": {
                    "default": 1e-05,
                    "description": "Weight decay for optimizer",
                    "minimum": 0.0,
                    "title": "Weight Decay",
                    "type": "number"
                },
                "patch_size": {
                    "default": 64,
                    "description": "Size of 3D patches to extract (cubic patches)",
                    "maximum": 128,
                    "minimum": 32,
                    "title": "Patch Size",
                    "type": "integer"
                },
                "samples_per_volume": {
                    "default": 20,
                    "description": "Number of patches to sample per volume per epoch",
                    "maximum": 100,
                    "minimum": 1,
                    "title": "Samples Per Volume",
                    "type": "integer"
                },
                "foreground_oversample": {
                    "default": 0.9,
                    "description": "Probability of sampling foreground patches (0.0-1.0)",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Foreground Oversample",
                    "type": "number"
                },
                "use_augmentation": {
                    "default": true,
                    "description": "Whether to apply data augmentation during training",
                    "title": "Use Augmentation",
                    "type": "boolean"
                },
                "augmentation_probability": {
                    "default": 0.5,
                    "description": "Probability of applying each augmentation",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Augmentation Probability",
                    "type": "number"
                },
                "class_weights": {
                    "anyOf": [
                        {
                            "items": {
                                "type": "number"
                            },
                            "type": "array"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Class weights for loss function (length must match num_classes). If None, uses default weights.",
                    "title": "Class Weights"
                },
                "lr_scheduler_patience": {
                    "default": 10,
                    "description": "Patience for ReduceLROnPlateau scheduler",
                    "minimum": 1,
                    "title": "Lr Scheduler Patience",
                    "type": "integer"
                },
                "early_stopping_patience": {
                    "default": 20,
                    "description": "Number of epochs with no improvement before stopping (0 = disabled)",
                    "minimum": 0,
                    "title": "Early Stopping Patience",
                    "type": "integer"
                },
                "eval_interval": {
                    "default": 1,
                    "description": "Evaluate on validation set every N epochs",
                    "minimum": 1,
                    "title": "Eval Interval",
                    "type": "integer"
                },
                "save_checkpoint_interval": {
                    "default": 5,
                    "description": "Save model checkpoint every N epochs",
                    "minimum": 1,
                    "title": "Save Checkpoint Interval",
                    "type": "integer"
                },
                "num_workers": {
                    "default": 4,
                    "description": "Number of data loader workers",
                    "minimum": 0,
                    "title": "Num Workers",
                    "type": "integer"
                },
                "random_seed": {
                    "default": 42,
                    "description": "Random seed for reproducibility",
                    "title": "Random Seed",
                    "type": "integer"
                },
                "use_gpu": {
                    "default": true,
                    "description": "Whether to use GPU if available",
                    "title": "Use Gpu",
                    "type": "boolean"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "TrainingMetrics": {
                    "description": "Training metrics for a single epoch",
                    "properties": {
                        "epoch": {
                            "title": "Epoch",
                            "type": "integer"
                        },
                        "train_loss": {
                            "title": "Train Loss",
                            "type": "number"
                        },
                        "val_loss": {
                            "anyOf": [
                                {
                                    "type": "number"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Val Loss"
                        },
                        "val_dice": {
                            "anyOf": [
                                {
                                    "type": "number"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Val Dice"
                        },
                        "learning_rate": {
                            "title": "Learning Rate",
                            "type": "number"
                        }
                    },
                    "required": [
                        "epoch",
                        "train_loss",
                        "learning_rate"
                    ],
                    "title": "TrainingMetrics",
                    "type": "object"
                }
            },
            "description": "Model Training Piece Output Model",
            "properties": {
                "model_path": {
                    "description": "Path to the saved trained model",
                    "title": "Model Path",
                    "type": "string"
                },
                "checkpoint_dir": {
                    "description": "Directory containing all checkpoints",
                    "title": "Checkpoint Dir",
                    "type": "string"
                },
                "best_model_path": {
                    "description": "Path to the best model (highest validation Dice)",
                    "title": "Best Model Path",
                    "type": "string"
                },
                "best_val_dice": {
                    "description": "Best validation Dice score achieved",
                    "title": "Best Val Dice",
                    "type": "number"
                },
                "best_epoch": {
                    "description": "Epoch number where best validation Dice was achieved",
                    "title": "Best Epoch",
                    "type": "integer"
                },
                "final_train_loss": {
                    "description": "Final training loss",
                    "title": "Final Train Loss",
                    "type": "number"
                },
                "total_epochs_trained": {
                    "description": "Total number of epochs trained",
                    "title": "Total Epochs Trained",
                    "type": "integer"
                },
                "training_history": {
                    "description": "Complete training history",
                    "items": {
                        "$ref": "#/$defs/TrainingMetrics"
                    },
                    "title": "Training History",
                    "type": "array"
                },
                "training_summary": {
                    "description": "Text summary of training process",
                    "title": "Training Summary",
                    "type": "string"
                },
                "plots_dir": {
                    "description": "Directory containing training plots",
                    "title": "Plots Dir",
                    "type": "string"
                }
            },
            "required": [
                "model_path",
                "checkpoint_dir",
                "best_model_path",
                "best_val_dice",
                "best_epoch",
                "final_train_loss",
                "total_epochs_trained",
                "training_history",
                "training_summary",
                "plots_dir"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/ModelTrainingPiece"
    },
    "NiftiVisualizationPiece": {
        "name": "NiftiVisualizationPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "Medical Imaging",
            "Visualization",
            "NIfTI",
            "MRI",
            "Segmentation"
        ],
        "style": {
            "node_label": "NIfTI Visualization",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#b3e0ff"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:image",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "description": "Visualizes NIfTI medical imaging data with optional mask overlay in axial, sagittal, or coronal planes",
        "input_schema": {
            "description": "NIfTI Visualization Piece Input Model\n\nStandalone piece that loads NIfTI files directly from directories\nand creates a grid visualization. No upstream connection required.",
            "properties": {
                "images_path": {
                    "default": "/home/shared_storage/medical_data/images",
                    "description": "Path to directory containing NIfTI image files (.nii.gz)",
                    "title": "Images Path",
                    "type": "string"
                },
                "masks_path": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": "/home/shared_storage/medical_data/masks",
                    "description": "Path to directory containing NIfTI mask files (.nii.gz). Optional.",
                    "title": "Masks Path"
                },
                "file_pattern": {
                    "default": "*.nii.gz",
                    "description": "Glob pattern to match NIfTI files (e.g., '*.nii.gz')",
                    "title": "File Pattern",
                    "type": "string"
                },
                "max_subjects": {
                    "default": 50,
                    "description": "Maximum number of subjects to visualize",
                    "maximum": 100,
                    "minimum": 1,
                    "title": "Max Subjects",
                    "type": "integer"
                },
                "slice_index": {
                    "anyOf": [
                        {
                            "type": "integer"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "description": "Slice index to visualize. If None, uses middle slice.",
                    "title": "Slice Index"
                },
                "view_plane": {
                    "default": "axial",
                    "description": "Anatomical plane to visualize",
                    "enum": [
                        "axial",
                        "sagittal",
                        "coronal"
                    ],
                    "title": "View Plane",
                    "type": "string"
                },
                "show_mask_overlay": {
                    "default": true,
                    "description": "Whether to overlay mask on image",
                    "title": "Show Mask Overlay",
                    "type": "boolean"
                },
                "mask_alpha": {
                    "default": 0.5,
                    "description": "Transparency of mask overlay (0.0 = transparent, 1.0 = opaque)",
                    "maximum": 1.0,
                    "minimum": 0.0,
                    "title": "Mask Alpha",
                    "type": "number"
                },
                "color_map": {
                    "default": "gray",
                    "description": "Matplotlib colormap for image (e.g., 'gray', 'viridis', 'bone')",
                    "title": "Color Map",
                    "type": "string"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "description": "NIfTI Visualization Piece Output Model",
            "properties": {
                "num_subjects": {
                    "description": "Number of subjects visualized",
                    "title": "Num Subjects",
                    "type": "integer"
                },
                "subject_ids": {
                    "description": "List of subject IDs that were visualized",
                    "items": {
                        "type": "string"
                    },
                    "title": "Subject Ids",
                    "type": "array"
                },
                "view_plane": {
                    "description": "Anatomical plane that was visualized",
                    "title": "View Plane",
                    "type": "string"
                },
                "grid_size": {
                    "description": "Grid size (rows x columns)",
                    "title": "Grid Size",
                    "type": "string"
                },
                "visualization_summary": {
                    "description": "Summary of visualization",
                    "title": "Visualization Summary",
                    "type": "string"
                }
            },
            "required": [
                "num_subjects",
                "subject_ids",
                "view_plane",
                "grid_size",
                "visualization_summary"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/NiftiVisualizationPiece",
        "secrets_schema": null
    },
    "GenerativeShapesPiece": {
        "name": "GenerativeShapesPiece",
        "dependency": {
            "dockerfile": "Dockerfile",
            "requirements_file": null
        },
        "tags": [
            "generation",
            "image",
            "shapes"
        ],
        "style": {
            "node_label": "Example Shapes Piece",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:paint-brush",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "Generative Shapes Piece",
        "description": "Generates a PNG image containing simple geometric shapes (circles, squares, triangles).",
        "container_resources": {
            "cpu": 500,
            "memory": "512Mi"
        },
        "input_schema": {
            "properties": {
                "width": {
                    "default": 256,
                    "minimum": 1,
                    "title": "Width",
                    "type": "integer"
                },
                "height": {
                    "default": 256,
                    "minimum": 1,
                    "title": "Height",
                    "type": "integer"
                },
                "background_color": {
                    "default": "#FFFFFF",
                    "title": "Background Color",
                    "type": "string"
                },
                "shape": {
                    "default": "circle",
                    "enum": [
                        "circle",
                        "square",
                        "triangle"
                    ],
                    "title": "Shape",
                    "type": "string"
                },
                "count": {
                    "default": 5,
                    "maximum": 200,
                    "minimum": 1,
                    "title": "Count",
                    "type": "integer"
                },
                "shape_size": {
                    "default": 30,
                    "minimum": 1,
                    "title": "Shape Size",
                    "type": "integer"
                },
                "color": {
                    "default": "#FF0000",
                    "title": "Color",
                    "type": "string"
                },
                "seed": {
                    "anyOf": [
                        {
                            "type": "integer"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": 42,
                    "title": "Seed"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "properties": {
                "message": {
                    "title": "Message",
                    "type": "string"
                },
                "file_path": {
                    "title": "File Path",
                    "type": "string"
                },
                "image_base64": {
                    "anyOf": [
                        {
                            "type": "string"
                        },
                        {
                            "type": "null"
                        }
                    ],
                    "default": null,
                    "title": "Image Base64"
                }
            },
            "required": [
                "message",
                "file_path"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/GenerativeShapesPiece"
    },
    "HelloWorldPiece": {
        "name": "HelloWorldPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "example",
            "text",
            "hello-world"
        ],
        "style": {
            "node_label": "Hello World",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ebebeb"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:hand-wave",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "title": "Hello World Piece",
        "description": "A simple piece that generates greeting messages.",
        "container_resources": {
            "cpu": 100,
            "memory": "128Mi"
        },
        "input_schema": {
            "description": "Hello World Piece Input Model",
            "properties": {
                "name": {
                    "default": "World",
                    "description": "Name to greet",
                    "title": "Name",
                    "type": "string"
                }
            },
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "description": "Hello World Piece Output Model",
            "properties": {
                "message": {
                    "description": "Greeting message",
                    "title": "Message",
                    "type": "string"
                }
            },
            "required": [
                "message"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/HelloWorldPiece"
    },
    "NiftiEDAPiece": {
        "name": "NiftiEDAPiece",
        "dependency": {
            "dockerfile": null,
            "requirements_file": "requirements.txt"
        },
        "tags": [
            "Medical Imaging",
            "EDA",
            "Visualization",
            "NIfTI",
            "Analytics",
            "Statistics"
        ],
        "style": {
            "node_label": "NIfTI EDA",
            "node_type": "default",
            "node_style": {
                "backgroundColor": "#ffcc99"
            },
            "useIcon": true,
            "icon_class_name": "fa-solid:chart-bar",
            "iconStyle": {
                "cursor": "pointer"
            }
        },
        "description": "Performs comprehensive Exploratory Data Analysis (EDA) on NIfTI medical imaging datasets with visual graphs and statistics",
        "input_schema": {
            "$defs": {
                "SubjectInfo": {
                    "description": "Information about a single subject/scan",
                    "properties": {
                        "subject_id": {
                            "title": "Subject Id",
                            "type": "string"
                        },
                        "image_path": {
                            "title": "Image Path",
                            "type": "string"
                        },
                        "mask_path": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "default": null,
                            "title": "Mask Path"
                        }
                    },
                    "required": [
                        "subject_id",
                        "image_path"
                    ],
                    "title": "SubjectInfo",
                    "type": "object"
                }
            },
            "description": "NIfTI EDA Piece Input Model",
            "properties": {
                "subjects": {
                    "description": "List of subjects to analyze",
                    "items": {
                        "$ref": "#/$defs/SubjectInfo"
                    },
                    "title": "Subjects",
                    "type": "array"
                },
                "output_dir": {
                    "default": "/home/shared_storage/eda_results",
                    "description": "Directory to save EDA visualizations and reports",
                    "title": "Output Dir",
                    "type": "string"
                },
                "max_subjects": {
                    "default": 50,
                    "description": "Maximum number of subjects to analyze (for performance)",
                    "maximum": 200,
                    "minimum": 1,
                    "title": "Max Subjects",
                    "type": "integer"
                },
                "generate_3d_plots": {
                    "default": false,
                    "description": "Whether to generate 3D volume visualizations (computationally expensive)",
                    "title": "Generate 3D Plots",
                    "type": "boolean"
                },
                "num_sample_slices": {
                    "default": 10,
                    "description": "Number of random slices to sample for intensity distribution analysis",
                    "maximum": 50,
                    "minimum": 1,
                    "title": "Num Sample Slices",
                    "type": "integer"
                }
            },
            "required": [
                "subjects"
            ],
            "title": "InputModel",
            "type": "object"
        },
        "output_schema": {
            "$defs": {
                "EDAStatistics": {
                    "description": "Summary statistics from EDA",
                    "properties": {
                        "total_subjects": {
                            "title": "Total Subjects",
                            "type": "integer"
                        },
                        "analyzed_subjects": {
                            "title": "Analyzed Subjects",
                            "type": "integer"
                        },
                        "volume_shape_mean": {
                            "items": {
                                "type": "number"
                            },
                            "title": "Volume Shape Mean",
                            "type": "array"
                        },
                        "volume_shape_std": {
                            "items": {
                                "type": "number"
                            },
                            "title": "Volume Shape Std",
                            "type": "array"
                        },
                        "intensity_mean": {
                            "title": "Intensity Mean",
                            "type": "number"
                        },
                        "intensity_std": {
                            "title": "Intensity Std",
                            "type": "number"
                        },
                        "mask_coverage_mean": {
                            "title": "Mask Coverage Mean",
                            "type": "number"
                        },
                        "class_distribution": {
                            "title": "Class Distribution",
                            "type": "object"
                        }
                    },
                    "required": [
                        "total_subjects",
                        "analyzed_subjects",
                        "volume_shape_mean",
                        "volume_shape_std",
                        "intensity_mean",
                        "intensity_std",
                        "mask_coverage_mean",
                        "class_distribution"
                    ],
                    "title": "EDAStatistics",
                    "type": "object"
                }
            },
            "description": "NIfTI EDA Piece Output Model",
            "properties": {
                "statistics": {
                    "allOf": [
                        {
                            "$ref": "#/$defs/EDAStatistics"
                        }
                    ],
                    "description": "Summary statistics from the analysis"
                },
                "report_path": {
                    "description": "Path to the generated EDA report (HTML or markdown)",
                    "title": "Report Path",
                    "type": "string"
                },
                "visualization_dir": {
                    "description": "Directory containing all generated visualizations",
                    "title": "Visualization Dir",
                    "type": "string"
                },
                "num_visualizations": {
                    "description": "Number of visualization files created",
                    "title": "Num Visualizations",
                    "type": "integer"
                },
                "analysis_summary": {
                    "description": "Text summary of key findings",
                    "title": "Analysis Summary",
                    "type": "string"
                }
            },
            "required": [
                "statistics",
                "report_path",
                "visualization_dir",
                "num_visualizations",
                "analysis_summary"
            ],
            "title": "OutputModel",
            "type": "object"
        },
        "secrets_schema": null,
        "source_url": "https://github.com/PatrikBorzik2426/BorzikPieces/tree/main/pieces/NiftiEDAPiece"
    }
}